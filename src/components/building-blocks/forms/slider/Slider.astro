---
const {
  label,
  name,
  checked = false,
  required = false,
  value = "on",
  class: className,
  _component,
  ...htmlAttributes
} = Astro.props;

const fieldId = htmlAttributes.id || `slider-${crypto.randomUUID()}`;
---

<div class:list={["slider", className]}>
  <label class="slider-container" for={fieldId}>
    <span class="slider-switch">
      <input
        type="checkbox"
        name={name}
        id={fieldId}
        checked={checked}
        required={required}
        aria-required={required}
        value={value}
        class="slider-input"
        {...htmlAttributes}
      />
      <span class="slider-track"></span>
    </span>
    {
      label && (
        <span class="slider-label">
          {label}
          {required && (
            <span class="slider-required" aria-label="required">
              *
            </span>
          )}
        </span>
      )
    }
  </label>
</div>

<style lang="pcss" is:global>
  @layer components {
    .slider {
      display: flex;
      width: 100%;
      margin: 0;
      margin-bottom: var(--spacing-md);

      .slider-container {
        align-items: center;
        cursor: pointer;
        display: flex;
        gap: var(--spacing-sm);
        width: 100%;
      }

      .slider-label {
        flex: 1;
      }

      .slider-required {
        color: red;
      }

      .slider-switch {
        display: inline-block;
        flex-shrink: 0;
        height: 26px;
        position: relative;
        width: 48px;
      }

      .slider-input {
        height: 0;
        opacity: 0;
        width: 0;
      }

      .slider-track {
        background-color: var(--color-border);
        border-radius: var(--radius-full);
        inset: 0;
        position: absolute;
        transition: var(--animation-normal) cubic-bezier(0.4, 0, 0.2, 1);
      }

      .slider-track::before {
        background-color: var(--color-bg);
        border-radius: var(--radius-full);
        bottom: 3px;
        box-shadow: 0 2px 4px var(--color-state-active);
        content: "";
        height: 20px;
        left: 3px;
        position: absolute;
        transition: var(--animation-normal) cubic-bezier(0.4, 0, 0.2, 1);
        width: 20px;
      }

      .slider-input:checked + .slider-track {
        background: var(--color-bg-inverse);
      }

      .slider-input:checked + .slider-track::before {
        transform: translateX(22px);
      }

      .slider-input:disabled + .slider-track {
        cursor: not-allowed;
        opacity: 0.5;
      }
    }
  }
</style>
