---
import clsx from "clsx";
import Icon from "../icon/icon.astro";
// @ts-ignore
import MarkdownIt from "markdown-it";

const {
  text,
  level,
  size,
  align,
  iconName,
  iconPosition,
  className,
  _bookshop_name,
  ...restProps
} = Astro.props;

const md = MarkdownIt({ html: true });
const MarkdownText = text ? md.renderInline(text) : "";

const classNames = clsx(
  "heading",
  `size-${size}`,
  `align-${align}`,
  iconPosition === "after" && "icon-after",
  className
);

const Tag = level;
const elementProps = {
  ...restProps,
};
---

<Tag {...elementProps as any} class:list={classNames}>
  {iconName && iconName.trim() && <Icon name={iconName} size="none" class="heading-icon" />}
  {MarkdownText}
</Tag>

<style>
  @layer components {
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      color: var(--element__body__font-color);
      font-weight: bold;
      margin-bottom: 0.5em;
      margin-top: 0.8em;
      align-items: center;
      display: flex;
      gap: 0.25em;

      em {
        font-weight: bold;
        background: var(--element__heading-emphasis__background-color);
        background-clip: text;
        -webkit-background-clip: text;
        color: transparent;
        font-style: normal;

        &::selection {
          color: var(--element__body__font-color);
          background: var(--element__selection__background-color);
        }
      }

      &.icon-after {
        flex-direction: row-reverse;
      }
    }

    .size-xs {
      font-size: var(--font-size-xs);
    }

    .size-s {
      font-size: var(--font-size-s);
    }

    .size-m {
      font-size: var(--font-size-m);
    }

    .size-l {
      font-size: var(--font-size-l);
    }

    .size-xl {
      font-size: var(--font-size-xl);
    }

    .size-2xl {
      font-size: var(--font-size-2xl);
    }

    .size-3xl {
      font-size: var(--font-size-3xl);
    }

    .size-4xl {
      font-size: var(--font-size-4xl);
    }

    .size-5xl {
      font-size: var(--font-size-5xl);
    }

    .size-6xl {
      font-size: var(--font-size-6xl);
    }

    h1 {
      font-size: var(--font-size-6xl);
      line-height: 1.2;
    }

    h2 {
      font-size: var(--font-size-5xl);
      line-height: 1.25;
    }

    h3 {
      font-size: var(--font-size-3xl);
      line-height: 1.3;
    }

    h4,
    h5,
    h6 {
      font-weight: normal;
    }

    h4 {
      font-size: var(--font-size-2xl);
      line-height: 1.35;
    }

    h5 {
      font-size: var(--font-size-xl);
      line-height: 1.4;
    }

    h6 {
      font-size: var(--font-size-lg);
      line-height: 1.45;
    }

    p,
    ul,
    ol {
      font-size: var(--font-size-md);
      line-height: 1.6;
      color: var(--element__body__font-color);
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    p,
    a,
    td,
    th,
    pre,
    code,
    li {
      overflow-wrap: break-word;
    }

    .align-start {
      text-align: start;
    }

    .align-center {
      text-align: center;
    }

    .align-end {
      text-align: end;
    }
  }
</style>
