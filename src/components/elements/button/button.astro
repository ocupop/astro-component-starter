---
import Icon from "../icon/icon.astro";

const {
  label,
  iconName,
  iconPosition = "before",
  hideText = false,
  variant = "primary",
  size = "md",
  link,
  element = "a",
  class: className,
  ...rest
} = Astro.props;

const htmlAttributes = Object.fromEntries(
  Object.entries(rest).filter(([key]) => !key.startsWith("_"))
);

if (hideText && !htmlAttributes["aria-label"]) {
  htmlAttributes["aria-label"] = label;
}

const Tag = element as any;

const tagProps = Tag === "a" && link ? { href: link } : Tag === "button" ? { type: "button" } : {};
---

<Tag
  class:list={[
    "button",
    `variant-${variant}`,
    `size-${size}`,
    iconPosition === "after" && "icon-after",
    hideText && "icon-only",
    className,
  ]}
  {...tagProps}
  {...htmlAttributes}
>
  {iconName && iconPosition !== "after" && <Icon name={iconName} size="none" />}
  {!hideText && label && <span>{label}</span>}
  {iconName && iconPosition === "after" && <Icon name={iconName} size="none" />}
</Tag>
