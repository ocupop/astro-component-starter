---
import Icon from "@components/elements/icon/icon.astro";
// @ts-ignore
import MarkdownIt from "markdown-it";

const {
  text,
  level = "h2",
  size,
  alignX = "start",
  iconName,
  iconPosition = "before",
  class: className,
  ...rest
} = Astro.props;

const htmlAttributes = Object.fromEntries(
  Object.entries(rest).filter(([key]) => key !== "_component")
);

const md = MarkdownIt({ html: true });
const MarkdownText = text ? md.renderInline(text) : "";
const Tag = level;
---

<Tag
  class:list={["heading", size && `size-${size}`, `align-${alignX}`, className]}
  {...htmlAttributes}
>
  {
    iconName && iconPosition == "before" && (
      <Icon
        name={iconName}
        size="none"
        class="heading-icon"
        aria-hidden="true"
        role="presentation"
      />
    )
  }
  {text ? <span class="heading-text" set:html={MarkdownText} /> : <slot />}
  {
    iconName && iconPosition === "after" && (
      <Icon
        name={iconName}
        size="none"
        class="heading-icon heading-icon-after"
        aria-hidden="true"
        role="presentation"
      />
    )
  }
</Tag>
